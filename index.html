<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.7.1 
 | Rendered using Apache Maven Fluido Skin 1.6
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="Content-Language" content="en" />
    <title>APILyzer Maven Plugin &#x2013; Description</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.6.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
      <script type="text/javascript" src="./js/apache-maven-fluido-1.6.min.js"></script>
      </head>
    <body class="topBarDisabled">
                  <a href="https://github.com/revelc/apilyzer-maven-plugin">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"
        alt="Fork me on GitHub">
    </a>
      <div class="container-fluid">
      <div id="banner">
        <div class="pull-left"><div id="bannerLeft"><h2>APILyzer Maven Plugin</h2>
</div>
</div>
        <div class="pull-right"></div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2017-12-15<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 1.2.0</li>
        </ul>
      </div>
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
<ul class="nav nav-list">
          <li class="nav-header">Overview</li>
    <li class="active"><a href="#"><span class="none"></span>Introduction</a>
  </li>
    <li><a href="plugin-info.html" title="Goals"><span class="none"></span>Goals</a>  </li>
          <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-down"></span>Project Information</a>
      <ul class="nav nav-list">
    <li><a href="dependencies.html" title="Dependencies"><span class="none"></span>Dependencies</a>  </li>
    <li><a href="dependency-info.html" title="Dependency Information"><span class="none"></span>Dependency Information</a>  </li>
    <li><a href="dependency-management.html" title="Dependency Management"><span class="none"></span>Dependency Management</a>  </li>
    <li><a href="distribution-management.html" title="Distribution Management"><span class="none"></span>Distribution Management</a>  </li>
    <li class="active"><a href="#"><span class="none"></span>About</a>
  </li>
    <li><a href="issue-tracking.html" title="Issue Management"><span class="none"></span>Issue Management</a>  </li>
    <li><a href="license.html" title="Licenses"><span class="none"></span>Licenses</a>  </li>
    <li><a href="mail-lists.html" title="Mailing Lists"><span class="none"></span>Mailing Lists</a>  </li>
    <li><a href="plugin-management.html" title="Plugin Management"><span class="none"></span>Plugin Management</a>  </li>
    <li><a href="plugins.html" title="Plugins"><span class="none"></span>Plugins</a>  </li>
    <li><a href="team-list.html" title="Team"><span class="none"></span>Team</a>  </li>
    <li><a href="source-repository.html" title="Source Code Management"><span class="none"></span>Source Code Management</a>  </li>
    <li><a href="project-summary.html" title="Summary"><span class="none"></span>Summary</a>  </li>
      </ul>
  </li>
    <li><a href="project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a>  </li>
  </ul>
<form id="search-form" action="https://www.google.com/search" method="get" >
      <input value="$sitesearchValue" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script type="text/javascript">asyncJs( 'https://cse.google.com/brand?form=search-form' )</script>
          <hr />
          <div id="poweredBy">
          <script type="text/javascript">asyncJs( 'https://apis.google.com/js/plusone.js' )</script>
        <div class="g-plusone" data-href="http://code.revelc.net/apilyzer-maven-plugin" data-size="tall" ></div>
                  <div class="clear"></div>
                  <iframe src="https://www.facebook.com/plugins/like.php?href=http://code.revelc.net/apilyzer-maven-plugin&send=false&layout=box_count&show-faces=false&action=like&colorscheme=light"
        scrolling="no" frameborder="0"
        style="border:none; width:48px; height:63px; margin-top: 10px;" ></iframe>
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
  <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
              </div>
          </div>
        </div>
        <div id="bodyColumn"  class="span10" >
<!--
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
--><div class="section">
<h2><a name="Description"></a>Description</h2>
<p>A simple maven plugin that detects some illegal changes to a Java project&#x2019;s  API.</p></div>
<div class="section">
<h2><a name="How_it_works"></a>How it works</h2>
<p>APILyzer looks for deviations from the following rules.</p>

<ul>
  
<li>Public API members should use other Public API types.</li>
  
<li>Public API members should use an approved set of types.</li>
</ul>
<p>APILyzer allows easy declaration of Public API Types and approved types. The  public members of the public API types are analyzed to ensure only expected  types are used. Public members include public methods, public fields, and  public inner classes. Protected classes and members are treated as public  during analysis.</p></div>
<div class="section">
<h2><a name="Other_tools"></a>Other tools</h2>
<p>This tool fills a niche not covered by other tools, like <a class="externalLink" href="http://mojo.codehaus.org/animal-sniffer-maven-plugin/">Animal Sniffer</a>  and <a class="externalLink" href="http://checkstyle.sourceforge.net/config_imports.html#ImportControl">checkstyle import control</a>. A project that wants to ensure API  stability would likely use these tools in addition to APILyzer. Import  analysis differs because it&#x2019;s ok for a public API class to import a non-public  API class for use only in its implementation. Comparing new API changes to  signatures of a previous API differs because it only validates that the old  API is not broken.</p></div>
<div class="section">
<h2><a name="How_to_use_it"></a>How to use it</h2>
<p>To add this plugin to your project, configure the plugin similarly to:</p>

<div class="source">
<div class="source"><pre class="prettyprint linenums">  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;net.revelc.code&lt;/groupId&gt;
        &lt;artifactId&gt;apilyzer-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;1.2.0&lt;/version&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;id&gt;apilyzer&lt;/id&gt;
            &lt;goals&gt;
              &lt;goal&gt;analyze&lt;/goal&gt;
            &lt;/goals&gt;
            &lt;configuration&gt;
              &lt;includes&gt;
                &lt;!--Specify one or more regular expressions that define the
                    public API.  Each regex is matched agains all fully
                    qualified class names.  Any class that matches (and is
                    public) is added to the set of public API classes.--&gt;
                &lt;include&gt;org[.]apache[.]accumulo[.]minicluster[.].*&lt;/include&gt;
              &lt;/includes&gt;
              &lt;excludes&gt;
                &lt;!-- Specifiy zero or more regular expressions. Any regex that
                     matches will exclude a prevously included class from the
                     set of API classes --&gt;
                &lt;exclude&gt;.*[.]impl[.].*&lt;/exclude&gt;
                &lt;exclude&gt;.*Impl&lt;/exclude&gt;
              &lt;/excludes&gt;
              &lt;allows&gt;
                &lt;!-- Specify zero or more regular expressions defining the set
                     of non-API classes thats it ok for public API members to
                     reference.  These regular expressions are matched against
                     fully qualified type names referenced by public API
                     members.  Conceptually, public API classes and Java classes
                     are automatically added to this set, so there is no need
                     to add those here. --&gt;
                &lt;allow&gt;org[.]apache[.]accumulo[.]core[.]client[.].*&lt;/allow&gt;
                &lt;allow&gt;org[.]apache[.]accumulo[.]core[.]data[.](Mutation|Key|Value|Condition|ConditionalMutation|Range|ByteSequence|PartialKey|Column)&lt;/allow&gt;
                &lt;allow&gt;org[.]apache[.]accumulo[.]core[.]security[.](ColumnVisibility|Authorizations)&lt;/allow&gt;
              &lt;/allows&gt;
            &lt;/configuration&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;
</pre></div></div>
<p>and build your project, similarly to (it runs at the verify phase by default):</p>

<div class="source">
<div class="source"><pre class="prettyprint linenums">mvn verify
</pre></div></div>
<p>Below is the output of running the above command.</p>

<div class="source">
<div class="source"><pre class="prettyprint linenums">Includes: [org[.]apache[.]accumulo[.]minicluster[.].*]
Excludes: [.*[.]impl[.].*, .*Impl]
Allowed: [org[.]apache[.]accumulo[.]core[.]client[.].*, org[.]apache[.]accumulo[.]core[.]data[.](Mutation|Key|Value|Condition|ConditionalMutation|Range|ByteSequence|PartialKey|Column), org[.]apache[.]accumulo[.]core[.]security[.](ColumnVisibility|Authorizations)]

Public API:
org.apache.accumulo.minicluster.MemoryUnit
org.apache.accumulo.minicluster.MiniAccumuloCluster
org.apache.accumulo.minicluster.MiniAccumuloConfig
org.apache.accumulo.minicluster.MiniAccumuloInstance
org.apache.accumulo.minicluster.MiniAccumuloRunner
org.apache.accumulo.minicluster.MiniAccumuloRunner$Opts
org.apache.accumulo.minicluster.MiniAccumuloRunner$PropertiesConverter
org.apache.accumulo.minicluster.ServerType

CONTEXT              TYPE                                                         FIELD/METHOD                        NON-PUBLIC REFERENCE

Method return        org.apache.accumulo.minicluster.MiniAccumuloInstance         getConfigProperties(...)            org.apache.commons.configuration.PropertiesConfiguration
Method param         org.apache.accumulo.minicluster.MiniAccumuloInstance         lookupInstanceName(...)             org.apache.accumulo.fate.zookeeper.ZooCache
</pre></div></div>
<p>The output shows the 8 types that APILyzer determined to be public API types based on its configuration and the maven dependencies. These are the 8 types that APILyzer analyzed.</p>
<p>The output also shows two problems APILyzer found with these 8 types. Both problems are with public API methods. The first problem is <tt>MiniAccumuloInstance.getConfigProperties()</tt> returns <tt>PropertiesConfiguration</tt> which is not a public API type. The second problem is <tt>MiniAccumuloInstance.lookupInstanceName()</tt> takes a parameter of type <tt>ZooCache</tt> which is not a public API type.</p></div>
<div class="section">
<h2><a name="Annotation_Example"></a>Annotation Example</h2>
<p>Hadoop has two annotations that it uses to communicate who should use its APIs. First, the <tt>InterfaceAudience</tt> annotation has values of <tt>Public</tt>, <tt>LimitedPrivate</tt>, and <tt>Private</tt>. Second, the <tt>InterfaceStability</tt> annotation has values of <tt>Stable</tt>, <tt>Evolving</tt>, and <tt>Unstable</tt>. In Hadoop the convention is to mark each API with an audience and stability annotation. The following example finds types marked Public+Stable using types that are not Public+Stable.</p>
<p>When trying to analyze a classes annotations, the class must be loaded. In the example below some classes could not be loaded because their dependencies were not on the classpath. However these classes were not in a package we cared about. Excluding classes not in the <tt>org.apache.hadoop</tt> package fixed this problem.</p>

<div class="source">
<div class="source"><pre class="prettyprint linenums">  &lt;configuration&gt;
     &lt;!--Look for Public+Stable APIs using Types that are not Public+Stable--&gt;
     &lt;includes&gt;
       &lt;!-- This class has no annotation, but seems like it sould be in API --&gt;
       &lt;include&gt;org[.]apache[.]hadoop[.]fs[.]RemoteIterator&lt;/include&gt;
     &lt;/includes&gt;
     &lt;includeAnnotations&gt;
       &lt;include&gt;
         [@]org[.]apache[.]hadoop[.]classification[.]InterfaceAudience[$]Public.*
       &lt;/include&gt;
     &lt;/includeAnnotations&gt;
     &lt;excludeAnnotations&gt;
       &lt;exclude&gt;
         [@]org[.]apache[.]hadoop[.]classification[.]InterfaceStability[$]Evolving.*
       &lt;/exclude&gt;
       &lt;exclude&gt;
         [@]org[.]apache[.]hadoop[.]classification[.]InterfaceStability[$]Unstable.*
       &lt;/exclude&gt;
       &lt;!-- If a class is included in the API, then its public inner classes are also (unless excluded).
            This exclude is for the case where a type w/ Private annotation is an inner class of a class
            with a Public annotation --&gt;
       &lt;exclude&gt;
         [@]org[.]apache[.]hadoop[.]classification[.]InterfaceAudience[$](Limited)?Private.*
       &lt;/exclude&gt;
    &lt;/excludeAnnotations&gt;
     &lt;excludes&gt;
        &lt;!-- Exclude all classes not in the org.apache.hadoop package --&gt;
        &lt;exclude&gt;(?!org[.]apache[.]hadoop.*).*&lt;/exclude&gt;
     &lt;/excludes&gt;
  &lt;/configuration&gt;
</pre></div></div></div>
        </div>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Copyright &copy;2017
<a href="https://github.com/revelc">Revelc</a>.
All rights reserved.</p>
        </div>
        </div>
    </footer>
    </body>
</html>
